# Window Generators
***Summary:** Multi-shape Envelope Generator*

***Width:** 20HP*
## Description
This module generates four complex envelopes based on four time parameters and a sustain level. The functions generated by this module are depicted below, in the [Envelope Shapes](#envelope-shapes-notice-the-time-synchronization-sustain-levels-will-be-the-same-for-each-envelope-in-reality) section and their peak voltage is `10V`. Window Generators module also provides 6 gate outputs that indicate which phase of the function the module is currently in (`T1`, `T2`, `T3`, `SUSTAIN`, `T4` and `END`).

The module can be triggered by applying a signal to either:
- `TRIGGER` trigger input; or
- `GATE` gate input (or by pressing the `Gate Button` manually)

The difference between these two input methods is that after finishing `T3` phase, the module is checking whether a gate signal is still high (above `1.8V`). When the signal is present, then the module stays in `SUSTAIN` phase, otherwise it proceeds to `T4` phase (except of `DAHR` output - see [Envelope Shapes](#envelope-shapes-notice-the-time-synchronization-sustain-levels-will-be-the-same-for-each-envelope-in-reality) section)

**The main envelope that determines the timing is `ADASR` (Attack - Decay - Attack - Sustain - Release) as this shape allows for easier stage change detection and timing.**

Each timed stage/phase can be controlled by an external voltage. The stage time decreases when the voltage applied is increasing. This is especially useful when the module is cycling - one can apply external voltage to control the frequency using `1V / octave` standard (see [Patching tips](#patching-tips) section for more information). In addition, one can use `ALL` input that affects all time parameters `T1`-`T4`, although without further control over signal scaling. The module also allows for setting the `SUSTAIN` level with external voltage.

Window Generators allows for changing the nonlinearity of the timed stages with `SHAPE` potentiometer. Internally, this parameter feeds each of the envelopes back to their time parameters. This way, one can control the rising and falling slopes of the signal between logarithmic (counterclockwise), linear (in the middle) and exponential (clockwise). Although, overall this will affect the module's stage timing.
### Envelope Shapes (notice the time synchronization, sustain levels will be the same for each envelope in reality)
#### DADSR
```
Attack(T2)  Decay(T3)
      ↘  /\ ↙
        /  \________
       /        ↑   \
      /      Sustain \
_____/                \___
  ↑                  ↑
Delay(T1)         Release(T4)
```
#### AHDSR
```
     _____  Decay(T3)
    /  ↑  \ ↙
   / Hold  \________
  /  (T2)      ↑    \
 /          Sustain  \
/                     \___
  ↑                  ↑
Attack(T1)        Release(T4)
```
#### DAHR
```
            Hold(T3)
          __↙
Attack   /  \
 (T2) ↘ /    \  Release(T4)
       /      \ ↙
      /        \
_____/          \_________
  ↑
Delay(T1)
```
#### ADASR
```
    /\   Decay(T2)
   /  \ ↙
  /    \    ________
 /      \  /   ↑    \
/        \/ Sustain  \____
  ↑        ↑        ↑
Attack   Attack  Release
 (T1)     (T3)     (T4)
```
## Connectivity
### Inputs
| Label | Description |
| --- | --- |
| `GATE`/`Gate Button` and `TRIGGER` | These inputs will trigger (above `1.8V`) all envelope generators which will perform initial steps until the sustain phase. Then, the sustain phase will be held as long as the gate is active, otherwise the envelopes will advance to the release/`T4` stage (except `DAHR` envelope) |
| ALL | Voltage control over all timed stages `T1`-`T4` |
| `T1`-`T4` CV | Voltage control over timed stage Tx. Compliant with `1V / octave` standard |
| `SUSTAIN` CV | Voltage control over the sustain phase level |
### Outputs
| Label | Voltage range | Description |
| --- | --- | --- |
| DADSR | 0V to 10V | `Delay-Attack-Decay-Sustain-Release` Envelope Output |
| AHDSR | 0V to 10V | `Attack-Hold-Decay-Sustain-Release` Envelope Output |
| DAHR | 0V to 10V | `Delay-Attack-Hold-Release` Envelope Output |
| ADASR | 0V to 10V | `Attack-Decay-Attack-Sustain-Release` Envelope Output |
| END | 0V or 5V | Gate output that generates high state (5V) when the `ADASR` envelope ends |
| `T1`-`T4` | 0V or 5V | Gate outputs indicating current timed stage for the `ADASR` envelope |
| SUSTAIN | 0V or 5V | Gate output indicating that the `ADASR` stage is in sustain phase |
## Patching tips
### Cycling (Oscillator/Low Frequency Oscillator/Clock Generator)
Patch `END` gate output back to either `GATE` or `TRIGGER` (recommended) input to enable the cycling mode. All envelope outputs will produce different wave shapes depending on the time, sustain and shape settings.

**All stages after `T3` can re-trigger the module, thus, you can also patch either `T4` or `SUSTAIN` output to the `TRIGGER` input.**

The time parameters will control the frequency of the waveform - one can provide `1V / octave` signal to any time related input. The shape potentiometer, apart from introducing the nonlinearity for the wave slopes, will also affect the frequency.

When the module is in cycling mode, it does not spend much time in the sustain phase. Changing the sustain level will create a sonic effect similar to the pulse width modulation for square waves.

In cycling mode (only when the `END` output is patched to `TRIGGER` input), it is possible to temporarily mute/pause the envelopes by applying gate signal (above `1.8V`) to the `GATE` input.
### Clock source operations (Clock Delay/Frequency Divider)
1. Patch any source (also at audio rates) to either `GATE` or `TRIGGER` input
2. You can use delayed envelopes (`DADSR` and `DAHR`) to generate similar waveforms but shifted in phase by `T1` time
3. It is also important to understand that the module cannot be re-triggered until it finishes `T3` stage, so, with careful `T1`-`T3` tuning, you can achieve a frequency divider effect with envelopes being active every Nth pulse of the gate/trigger source.
### Processing an arbitrary signal
To process any  incoming signal:
1. Patch `SUSTAIN` gate output back to the `GATE` input and push `Gate Button` to start the envelopes. After reaching the sustain phase, the module will indefinitely see a gate signal
2. Plug external signal (the one that should be processed) to the `SUSTAIN` voltage control input
3. The resulting signal (between `0V` and `10V`) will be available at `DADSR`, `AHDSR` and `ADASR` outputs with following time parameters controlling the slopes:

| Output | Rise time | Fall time |
| --- | --- | --- |
| `DADSR` | `T2` | `T4` |
| `AHDSR` | `T1` | `T4` |
| `ADASR` | `T3` | `T4` |

This patch can be used to perform many operations on the signal:
| Operation | Description |
| --- | --- |
| **Offset, Rectification/Clipping and Scale** | The `SUSTAIN` potentiometer acts as an offset voltage to the incoming signal. However, since the sustain level can only be a positive voltage up to `10V`, the resulting waveform will be clipped when it tries to go out of these bounds. One can also use `SUSTAIN` control voltage attenuverter to scale and/or invert the signal |
| **Filter and Slew** | The time parameters mentioned in the table above (and `ALL` voltage control input) can be used to slew (or make a low pass filter for audio rate) signals |
| **Wave Shaping** | The time parameters, in conjunction with `SHAPE` potentiometer, allow for changing the shape and nonlinearity of the resulting waveform |
| **Envelope Follower** | The time parameters (mentioned in the table above) can be fine tuned to act as an Envelope Follower. To achieve this effect, set fall/release time to be relatively long and tune the rise/attack time to be relatively short (not necessarily immediate) |